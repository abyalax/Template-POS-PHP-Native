var i=Object.defineProperty;var c=(r,a,e)=>a in r?i(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e;var n=(r,a,e)=>c(r,typeof a!="symbol"?a+"":a,e);import{formatPrice as o}from"../helper.js";import l from"./core.js";import{Chart as s}from"../node_modules/chart.js/dist/chart.js";class f{constructor(){n(this,"charts");n(this,"handleReportSalesByYear",async()=>{const a=await l.getReportSalesByYear(),e=document.getElementById("total-profit"),t=document.getElementById("total-revenue"),d=document.getElementById("total-sales");e.innerText=o(a.total_profit),t.innerText=o(a.total_revenue),d.innerText=o(a.total_sales),console.log(a)});n(this,"createRevenueChart",async a=>{const e=await l.getReportSalesByMonth();this.destroyChartFromCanvas(a),e&&(this.charts.revenue=new s(a,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"Sales",fill:!0,tension:.4,borderCapStyle:"round",pointRadius:.2,backgroundColor:"transparent",borderColor:"#30b4e1",data:e.map(t=>t.total_sales)},{label:"Revenue",fill:!0,tension:.4,borderCapStyle:"round",pointRadius:.2,backgroundColor:"transparent",borderColor:"#3b7ddd",data:e.map(t=>t.total_revenue)},{label:"Profit",fill:!0,tension:.4,borderCapStyle:"round",pointRadius:.2,backgroundColor:"transparent",borderColor:"#23bf93",borderDash:[4,4],data:e.map(t=>t.total_profit)}]},options:{aspectRatio:4/2,interaction:{intersect:!1,mode:"index"},plugins:{tooltip:{enabled:!0,mode:"index",callbacks:{label:t=>`${t.dataset.label} : Rp ${t.formattedValue}`}},legend:{display:!0,align:"center"}}}}))});n(this,"createSalesByCategoryChart",async a=>{this.destroyChartFromCanvas(a);const e=await l.getReportSalesByCategory();e&&(this.charts.category=new s(a,{type:"pie",data:{labels:e.map(t=>t.category),datasets:[{label:"Total Sales",data:e.map(t=>t.total_sales),borderWidth:1,backgroundColor:["#30b4e1","#3b7ddd","#23bf93","#ff6b6b","#ff9f43","#e9c46a"],hoverBackgroundColor:["#1e8fb7","#2662b0","#178068","#cc5252","#cc7c26","#b89a4f"]}]},options:{aspectRatio:1,plugins:{legend:{position:"top"},tooltip:{enabled:!0,mode:"nearest",callbacks:{title(t){return e[t[0].dataIndex].category},afterTitle(t){return`${e[t[0].dataIndex].total_qty} items sold`},beforeBody(t){return`Total Revenue: ${o(e[t[0].dataIndex].total_revenue)}`},afterBody(t){return`Total Profit: ${o(e[t[0].dataIndex].total_profit)}`},label(t){return`Total Sales: ${o(e[t.dataIndex].total_sales)}`}},displayColors:!1}},interaction:{intersect:!1,mode:"index"}}}))});this.charts={},this.bindEvents()}async bindEvents(){const a=document.getElementById("revenue-chart"),e=document.getElementById("category-chart");this.handleReportSalesByYear(),this.createRevenueChart(a),this.createSalesByCategoryChart(e),this.handleReportSalesByYear()}destroyChartFromCanvas(a){const e=s.getChart(a);e&&e.destroy()}}export{f as default};
